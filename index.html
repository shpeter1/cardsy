<!DOCTYPE html>
<html dir="rtl" lang="he">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
  <title>ğŸƒ ×”×©×™×˜×”××“ ×©×œ ×™×¦×—×§×™ ğŸƒ</title>
  <style>
    *{margin:0;padding:0;box-sizing:border-box;font-family:Arial,sans-serif;-webkit-tap-highlight-color:transparent;}
    body{background:linear-gradient(135deg,#2d5a27,#4a7c59);min-height:100vh;color:#fff;padding:10px;}
    .game-container{max-width:800px;margin:auto;}
    .game-title{text-align:center;font-size:2rem;margin-bottom:1rem;}
    .status{text-align:center;background:rgba(0,0,0,0.6);padding:10px;border-radius:5px;margin-bottom:1rem;}
    .game-area{display:grid;grid-template-rows:auto 1fr auto;gap:1rem;}
    .opponent-area,.player-area{background:rgba(0,0,0,0.3);padding:10px;border-radius:8px;}
    .opponent-area h3,.player-area h3{text-align:center;margin-bottom:0.5rem;}
    .cards-container{display:flex;flex-wrap:wrap;gap:6px;justify-content:center;}
    .card{width:60px;height:90px;background:#fff;border:1px solid #ccc;border-radius:6px;display:flex;align-items:center;justify-content:center;font-weight:bold;color:#333;cursor:pointer;user-select:none;touch-action:manipulation;}
    .card-back{background:linear-gradient(135deg,#1e3a8a,#3b82f6);color:transparent;}
    .card.selected{outline:3px solid #ffc107;}
    .center-area{text-align:center;padding:10px;background:rgba(0,0,0,0.3);border-radius:8px;}
    button{padding:8px 12px;margin:4px;border:none;border-radius:5px;font-size:1rem;}
    .btn-primary{background:#0d6efd;color:#fff;}
    .btn-secondary{background:#6c757d;color:#fff;}
  </style>
</head>
<body>
  <div class="game-container">
    <h1 class="game-title">ğŸƒ ×”×©×™×˜×”××“ ×©×œ ×™×¦×—×§×™ ğŸƒ</h1>
    <div id="gameStatus" class="status">×”×ª×—×œ ××©×—×§ ×œ×‘×—×™×¨×ª ×§×œ×¤×™×</div>
    <div class="game-area">
      <div class="opponent-area">
        <h3>ğŸ§” ×™×”×•×“×”</h3>
        <div class="cards-container" id="opponentClosed"></div>
        <div class="cards-container" id="opponentOpen"></div>
        <div class="cards-container" id="opponentHand"></div>
      </div>
      <div class="center-area">
        <div>×—×¤×™×¡×”: <span id="deckCount">0</span></div>
        <div class="cards-container" id="pile"></div>
        <button id="startBtn" class="btn-primary">×”×ª×—×œ ××©×—×§</button>
        <button id="playBtn" class="btn-primary" disabled>×©×—×§ ×§×œ×¤×™×</button>
        <button id="takeBtn" class="btn-secondary" disabled>×§×— ×¢×¨×™××”</button>
      </div>
      <div class="player-area">
        <h3>ğŸ‘¤ ××ª×”</h3>
        <div class="cards-container" id="playerClosed"></div>
        <div class="cards-container" id="playerOpen"></div>
        <div class="cards-container" id="playerHand"></div>
      </div>
    </div>
  </div>
  <script>
    class Game {
      constructor(){
        this.suits=['â™ ','â™¥','â™¦','â™£'];
        this.values=['3','4','5','6','7','8','9','10','J','Q','K','A','2'];
        this.deck=[]; this.pile=[];
        this.playerClosed=[]; this.playerOpen=[]; this.playerHand=[];
        this.opponentClosed=[]; this.opponentOpen=[]; this.opponentHand=[];
        this.selected=[];
        this.phase=0; // 0 setup,1 play
        this.initDeck(); this.attach();
      }
      initDeck(){
        this.deck=[]; for(let s of this.suits) for(let v of this.values) this.deck.push({suit:s,value:v});
        for(let i=this.deck.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[this.deck[i],this.deck[j]]=[this.deck[j],this.deck[i]];}
        document.getElementById('deckCount').textContent=this.deck.length;
      }
      attach(){
        document.getElementById('startBtn').onclick=()=>this.start();
        document.getElementById('playBtn').onclick=()=>this.play();
        document.getElementById('takeBtn').onclick=()=>this.take();
      }
      start(){
        // deal 3 closed,3 open,3 hand
        for(let i=0;i<3;i++){this.playerClosed.push(this.deck.pop());this.opponentClosed.push(this.deck.pop());}
        for(let i=0;i<3;i++){this.playerOpen.push(this.deck.pop());this.opponentOpen.push(this.deck.pop());}
        for(let i=0;i<3;i++){this.playerHand.push(this.deck.pop());this.opponentHand.push(this.deck.pop());}
        this.phase=1; this.update();
      }
      renderZone(id,arr,hide){
        const cont=document.getElementById(id); cont.innerHTML='';
        arr.forEach((c,i)=>{
          let div=document.createElement('div');
          div.className='card'+(hide?' card-back':'');
          div.textContent=hide?'':c.value+c.suit;
          div.onclick=()=>this.clickCard(id,i);
          cont.appendChild(div);
        });
      }
      clickCard(zone,i){
        if(this.phase!==1||zone!=='playerHand')return;
        const card=this.playerHand.splice(i,1)[0];
        // toggle selection
        let idx=this.selected.indexOf(card);
        if(idx>-1) this.selected.splice(idx,1);
        else this.selected.push(card);
        this.playerHand.push(card);
        this.update();
      }
      canPlay(card){
        if(!this.pile.length) return true;
        const top=this.pile[this.pile.length-1];
        if(card.value==='2'||card.value==='10'||top.value==='2') return true;
        if(top.value==='7') return this.val(card)<=7;
        return this.val(card)>=this.val(top);
      }
      val(c){return{'3':3,'4':4,'5':5,'6':6,'7':7,'8':8,'9':9,'10':10,'J':11,'Q':12,'K':13,'A':14,'2':15}[c.value];}
      play(){
        if(!this.selected.length)return;
        if(!this.selected.every(c=>c.value===this.selected[0].value)){alert('×‘×—×¨ ×§×œ×¤×™× ×××•×ª×• ×¢×¨×š');return;}
        if(!this.selected.some(c=>this.canPlay(c))){alert('×œ× ×—×•×§×™');return;}
        this.pile.push(...this.selected);
        this.selected=[];
        this.update();
      }
      take(){
        this.playerHand.push(...this.pile);
        this.pile=[];
        this.update();
      }
      update(){
        this.renderZone('playerClosed',this.playerClosed,true);
        this.renderZone('playerOpen',this.playerOpen,false);
        this.renderZone('playerHand',this.playerHand,false);
        this.renderZone('opponentClosed',this.opponentClosed,true);
        this.renderZone('opponentOpen',this.opponentOpen,false);
        this.renderZone('opponentHand',this.opponentHand,false);
        this.renderZone('pile',this.pile,false);
        document.getElementById('deckCount').textContent=this.deck.length;
        document.getElementById('gameStatus').textContent = this.phase===0?
          '×‘×—×¨ 3 ×”×¤×ª×•×—,3 ×¡×’×•×¨ ×•-3 ×‘×™×“ ×•××– ×”×ª×—×œ×ª ××©×—×§':'×‘×—×¨ ×§×œ×¤×™× ×•××– ×œ×—×¥ ×©×—×§';
        document.getElementById('playBtn').disabled=this.selected.length===0;
        document.getElementById('takeBtn').disabled=false;
      }
    }
    window.onload=()=>window.g=new Game();
  </script>
</body>
</html>
